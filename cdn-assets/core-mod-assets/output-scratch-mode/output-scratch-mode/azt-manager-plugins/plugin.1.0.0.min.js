!function(){"use strict";const i="azt-manager-plugins";var a,e,t;(t=a=a||{})[t.FRAME=0]="FRAME",t[t.DOCUMENT=1]="DOCUMENT",t[t.ALL=2]="ALL",(t=e=e||{})[t.AztSigma=0]="AztSigma",t[t.AztImage=1]="AztImage",t[t.AztAdd=2]="AztAdd",t[t.AztBadge=3]="AztBadge",t[t.AztLayoutList=4]="AztLayoutList",t[t.AztBraces=5]="AztBraces",t[t.AztListChecks=6]="AztListChecks";const o={setup:(t,n)=>{t.addCommand("aztAddSuggestionActionMenu",(t,e)=>{n.addOneMenu(e)})},call:(t,e)=>{t.execCommand("aztAddSuggestionActionMenu",!1,e)},name:"aztAddSuggestionActionMenu"},s={setup:(t,n)=>{t.addCommand("aztHiddenOneSuggestionActionMenu",(t,e)=>{n.hiddenOneMenu(e)})},call:(t,e)=>{t.execCommand("aztHiddenOneSuggestionActionMenu",!1,e)},name:"aztHiddenOneSuggestionActionMenu"},r={setup:(t,n)=>{t.addCommand("aztOpenOneSuggestionActionMenu",(t,e)=>{n.openOneMenu(e)})},call:(t,e)=>{t.execCommand("aztOpenOneSuggestionActionMenu",!1,e)},name:"aztOpenOneSuggestionActionMenu"},l={setup:(t,n)=>{t.addCommand("aztHiddenSuggestionActionMenu",(t,e)=>{n.hidden(e)})},call:(t,e)=>{t.execCommand("aztHiddenSuggestionActionMenu",!1,e)},name:"aztHiddenSuggestionActionMenu"},d={setup:(t,n)=>{t.addCommand("aztLoadScriptSource",(t,e)=>{n.loadSrcJs(e.name,e.url,e.mode).then(e.callback)})},call:(t,e)=>{t.execCommand("aztLoadScriptSource",!1,e)},name:"aztLoadScriptSource"},c={setup:(t,n)=>{t.addCommand("aztLoadMultipleScriptSource",(t,e)=>{n.loadMultipleSrcJs(e.lst).then(e.callback)})},call:(t,e)=>{t.execCommand("aztLoadMultipleScriptSource",!1,e)},name:"aztLoadMultipleScriptSource"},h={setup:(t,n)=>{t.addCommand("aztLoadStyleSource",(t,e)=>{n.loadStyle(e.name,e.content,e.mode)})},call:(t,e)=>{t.execCommand("aztLoadStyleSource",!1,e)},name:"aztLoadStyleSource"},u={setup:(t,n)=>{t.addCommand("aztSetContentPlaceholderActionMenu",(t,e)=>{n.setContent(e)})},call:(t,e)=>{t.execCommand("aztSetContentPlaceholderActionMenu",!1,e)},name:"aztSetContentPlaceholderActionMenu"};class n{constructor(t){this.editor=t}loadScript(e,n,i){return new Promise(t=>{d.call(this.editor,{name:e,url:n,mode:i,callback:t})})}loadMultipleScript(e){return new Promise(t=>{c.call(this.editor,{lst:e,callback:t})})}loadStyle(t,e,n){return h.call(this.editor,{name:t,content:e,mode:n})}hiddenSuggestionMenu(t){return l.call(this.editor,t)}addOneSuggestionMenu(t,e,n,i,s){return o.call(this.editor,{name:t,callback:e,svgIcon:n,hidden:i,hiddenOnExcuse:s})}openOneSuggestionMenu(t){return r.call(this.editor,t)}hiddenOneSuggestionMenu(t){return s.call(this.editor,t)}setContentPlaceholder(t){return u.call(this.editor,t)}pushJsonContent(t,e){return this.editor.fire("azt-dispatch-push-json-content",{name:t,content:e})}static replaceTranslateService(t){Object.prototype.hasOwnProperty.call(window,"aztEditorFnsTranslateService")||(window.aztEditorFnsTranslateService=t)}translate(t,e){return window.aztEditorFnsTranslateService?window.aztEditorFnsTranslateService(t,e):null!=e?e:t}}class m{static getCaretContainer(t){t=t.getWin().getSelection();let e,n;return 0<t.rangeCount&&(n=t.getRangeAt(0),e=n.commonAncestorContainer),e}}class p{constructor(t,e){this.editor=t,this.pluginApi=e,this.element=this.getElementForRoot(),this.setContent(this.pluginApi.translate("lang_cms_common_start_answer_input","Gõ [kbd=/] để mở công cụ. Gõ [kbd=A.] nội dung + [kbd=tab] hoặc [kbd=enter] để bắt đầu nhập đáp án")),document.body.appendChild(this.element),t.on("keydown",()=>{this.normalCheckStartLineEmpty()}),t.on("keyup",()=>{this.normalCheckStartLineEmpty()}),t.on("change",()=>{this.normalCheckStartLineEmpty()}),t.on("click",()=>{this.normalCheckStartLineEmpty()}),t.on("blur",()=>{this.hidden()})}getElementForRoot(){var t=document.getElementById(p.RootElementId);return t||((t=document.createElement("div")).classList.add("azt-editor-placeholder"),t.id=p.RootElementId,document.body.appendChild(t),t)}setContent(t){this.element.innerHTML=t.replace(/\[kbd=([a-zA-Z0-9./]*)\]/g,(t,e)=>this.kbd(e))}normalCheckStartLineEmpty(){var t=this.editor.selection.getRng(),e=t.startContainer.textContent;return 0===t.startOffset&&0===e.length?(t=m.getCaretContainer(this.editor).getBoundingClientRect(),this.open(t.y,t.x)):this.hidden()}open(t,e){var n=document.body.getBoundingClientRect(),i=this.editor.getContentAreaContainer().getBoundingClientRect(),n=i.top-n.top,i=i.x;this.element.style.display="flex",this.element.style.top=n+t+3+"px",this.element.style.left=i+e+"px"}hidden(){this.element.style.display="none",this.element.style.top="",this.element.style.left=""}kbd(t){var e=document.createElement("kbd");return e.innerText=t,e.outerHTML}static get RootElementId(){return"azt-editor-plugin-placeholder-action"}}class g{static get SVG_ICONS(){var t=[];return t[e.AztSigma]='<svg style="fill: none !important;" width="22" height="22" aria-hidden="true" focusable="false" data-prefix="fad" data-icon="function" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><g class="fa-duotone-group"><path class="fa-secondary" fill="currentColor" d="M330.7 177.7C303.7 218.4 288 267.3 288 320s15.7 101.6 42.7 142.3c9.8 14.7 5.7 34.6-9 44.3s-34.6 5.7-44.3-9C243.6 446.7 224 385.6 224 320s19.6-126.7 53.3-177.7c9.8-14.7 29.6-18.8 44.3-9s18.8 29.6 9 44.3zm202.6 0c-9.8-14.7-5.7-34.6 9-44.3s34.6-5.7 44.3 9C620.4 193.3 640 254.4 640 320s-19.6 126.7-53.3 177.7c-9.8 14.7-29.6 18.8-44.3 9s-18.8-29.6-9-44.3c27-40.7 42.7-89.6 42.7-142.3s-15.7-101.6-42.7-142.3z"></path><path class="fa-primary" fill="currentColor" d="M160 0C107 0 64 43 64 96v96H32c-17.7 0-32 14.3-32 32s14.3 32 32 32H64V383.5c0 16.1-12 29.8-28 31.8l-7.9 1C10.5 418.4-1.9 434.4 .3 452s18.2 30 35.7 27.8l7.9-1c48-6 84.1-46.8 84.1-95.3V256h32c17.7 0 32-14.3 32-32s-14.3-32-32-32H128V96c0-17.7 14.3-32 32-32h32c17.7 0 32-14.3 32-32s-14.3-32-32-32H160zM398.6 241.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L386.7 320l-33.4 33.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L432 365.3l33.4 33.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L477.3 320l33.4-33.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L432 274.7l-33.4-33.4z"></path></g></svg>',t[e.AztImage]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-image"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>',t[e.AztAdd]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-square"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M8 12h8"/><path d="M12 8v8"/></svg>',t[e.AztBadge]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-badge-check"><path d="M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z"/><path d="m9 12 2 2 4-4"/></svg>',t[e.AztLayoutList]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-layout-list"><rect width="7" height="7" x="3" y="3" rx="1"/><rect width="7" height="7" x="3" y="14" rx="1"/><path d="M14 4h7"/><path d="M14 9h7"/><path d="M14 15h7"/><path d="M14 20h7"/></svg>',t[e.AztBraces]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-braces"><path d="M8 3H7a2 2 0 0 0-2 2v5a2 2 0 0 1-2 2 2 2 0 0 1 2 2v5c0 1.1.9 2 2 2h1"/><path d="M16 21h1a2 2 0 0 0 2-2v-5c0-1.1.9-2 2-2a2 2 0 0 1-2-2V5a2 2 0 0 0-2-2h-1"/></svg>',t[e.AztListChecks]='<svg style="fill: none !important;" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-list-checks"><path d="m3 17 2 2 4-4"/><path d="m3 7 2 2 4-4"/><path d="M13 6h8"/><path d="M13 12h8"/><path d="M13 18h8"/></svg>',t}static svg(t){return g.SVG_ICONS[t]}}class S{constructor(t){this.editor=t,this.menus=[],this.element=this.getElementForRoot(),t.on("keyup",t=>{this.normalCheckEnableSuggestion(t)}),t.on("keydown",t=>{if("false"!==this.element.getAttribute("data-open")&&this.checkIgnoreKey(t.key))switch(t.preventDefault(),t.key){case"ArrowDown":this.processDownActiveItem();break;case"ArrowUp":this.processUpActiveItem()}})}processOnMouseMoveActive(t){var e;"false"!==this.element.getAttribute("data-open")&&t.target&&(t=t.target).closest&&(t=t.closest(".azt-editor-suggestion-menu-item"))&&((e=this.getCurrentActive())&&e.classList.remove("active"),t.classList.add("active"))}getCurrentActive(){return this.element.querySelector(".active")}processDownActiveItem(){var t=this.getCurrentActive();t&&(t.classList.remove("active"),t=this.element.querySelector(`li[data-index='${t.getAttribute("data-next")}']`))&&t.classList.add("active")}processUpActiveItem(){var t=this.getCurrentActive();t&&(t.classList.remove("active"),t=this.element.querySelector(`li[data-index='${t.getAttribute("data-pre")}']`))&&t.classList.add("active")}normalCheckEnableSuggestion(t){var e=m.getCaretContainer(this.editor),n=this.editor.getWin().getSelection();if(!this.checkIgnoreKey(t.key)){if(e&&t&&"Slash"===t.code){t=n.getRangeAt(0);if(1===t.startOffset||" "===e.textContent[t.startOffset-2]||" "===e.textContent[t.startOffset-2])return this.open(t.getBoundingClientRect().x,t.getBoundingClientRect().y)}this.hidden(!1)}}checkIgnoreKey(t){return["ArrowDown","ArrowUp","Enter"].includes(t)}open(t,e){this.draw(),t=t<50?50:t;var n=document.body.getBoundingClientRect(),i=this.editor.getContentAreaContainer().getBoundingClientRect(),n=i.top-n.top,i=i.x;this.element.style.display="block",this.element.style.top=n+e+"px",this.element.style.left=i+t+"px",this.element.setAttribute("data-open","true")}hidden(t){"none"!==this.element.style.display&&t&&this.editor.execCommand("delete",!1,null),this.element.style.display="none",this.element.setAttribute("data-open","false")}getElementForRoot(){var t=document.getElementById(S.RootElementId);return t||((t=document.createElement("div")).classList.add("azt-editor-suggestion"),t.id=S.RootElementId,document.body.appendChild(t),t.setAttribute("data-open","false"),document.addEventListener("mousemove",t=>{this.processOnMouseMoveActive(t)}),t)}draw(){this.element.innerHTML="",this.menu_open().forEach((t,e)=>{var n=document.createElement("li"),i=(n.classList.add("azt-editor-suggestion-menu-item"),n.setAttribute("data-index",e.toString()),0===e?this.menu_open().length-1:e-1),s=e===this.menu_open().length-1?0:e+1;n.setAttribute("data-pre",i.toString()),n.setAttribute("data-next",s.toString()),n.innerHTML=`<span>${g.svg(t.svgIcon)}</span><span>${t.name}</span>`,n.addEventListener("click",()=>{this.startExecCommand(t)}),0===e&&n.classList.add("active"),this.element.appendChild(n)})}startExecCommand(t){t.hiddenOnExcuse&&this.hidden(!0),this.editor.execCommand(t.callback)}addOneMenu(e){this.menus.find(t=>t.callback===e.callback)||this.menus.push(e)}openOneMenu(e){var t;e&&0!==e.length&&(t=this.menus.find(t=>t.callback===e))&&(t.hidden=!1)}hiddenOneMenu(e){var t;e&&0!==e.length&&(t=this.menus.find(t=>t.callback===e))&&(t.hidden=!0)}toggleOneMenu(e){var t;e&&0!==e.length&&(t=this.menus.find(t=>t.callback===e))&&(t.hidden=!t.hidden)}static get RootElementId(){return"azt-editor-plugin-suggestion-action"}menu_open(){return this.menus.filter(t=>!1===t.hidden)}registerEnterPressMasterKeyDown(t){var e;"false"!==this.element.getAttribute("data-open")&&(t.preventDefault(),t=this.getCurrentActive())&&(e=Number(t.getAttribute("data-index")),this.menu_open()[e])&&this.startExecCommand(this.menu_open()[e])}}class y{constructor(t,e){this.editor=t,this.source=e,this.pluginApi=new n(t),this.placeHolder=new p(t,this.pluginApi),this.suggestion=new S(t),this.setupApi()}setupApi(){return t=this.editor,e=this.source,n=this.suggestion,i=this.placeHolder,d.setup(t,e),c.setup(t,e),h.setup(t,e),o.setup(t,n),s.setup(t,n),l.setup(t,n),r.setup(t,n),u.setup(t,i),void t.dispatch("azt-dispatch-setup-api");var t,e,n,i}onHandleEnterPressMasterKeyDown(t){this.suggestion.registerEnterPressMasterKeyDown(t)}}class f{constructor(t,e,n){this.name=t,this.url=e,this.mode=n,this.callbacks=[]}load(t){return new Promise(e=>{var n=t.getElementsByTagName("script");for(let t=0;t<n.length;t++){const i=n[t];i.src===this.url&&(this.result=!0,this.callbacks.forEach(t=>t(!0)),e(!0))}let i=t.createElement("script");i.setAttribute("async","false"),t.head.appendChild(i),i.addEventListener("load",()=>{this.result=!0,this.callbacks.forEach(t=>t(!0)),e(!0)}),i.setAttribute("src",this.url)})}pushCallback(t){if(void 0!==this.result)return t(this.result);this.callbacks.push(t)}}class k{constructor(t,e,n){this.tasks=[],this.queues=[],this.is_running=!1,this.all_tasks=0,this.wrap_counter_done=0,this.count_task_root_done=0,this.limit_one_process=null!=t?t:5,this.result_common_temp={datas:[],errs:[]},this.action_log_item=e,this.end_with_error=null!=n&&n}addTask(t,n,e,i){if(!this.is_running){var s=e||[];const o=this.queues.length;this.all_tasks++,this.queues.push({task:()=>new Promise(e=>{n.call(t,...s).then(t=>{this.wrap_counter_done++,this.callLog(i),e({status:!0,value:t,index:o})}).catch(t=>{this.wrap_counter_done++,this.callLog(i),e({status:!1,error:t,index:o})})}),name:i})}}callLog(t){this.action_log_item&&0<this.all_tasks&&this.action_log_item.function.call({},this.wrap_counter_done,this.all_tasks,...this.action_log_item.params||[],t)}start(){return new Promise(t=>{0===this.queues.length&&t({datas:[],errs:[]}),this.result_common_temp={datas:[],errs:[]};for(let t=0;t<this.limit_one_process;t++){var e=this.queues.shift();if(!e)break;this.tasks.push(e)}this.count_task_root_done=0,this.is_running=!0,this.runner(t)})}checker(t,e){this.count_task_root_done++,t.status&&t.value?this.result_common_temp.datas.push({index:t.index,value:t.value}):t.error&&this.result_common_temp.errs.push({index:t.index,value:t.error}),0<this.result_common_temp.errs.length&&this.end_with_error&&(this.is_running=!1,e(this.makeResultObj())),this.count_task_root_done===this.all_tasks&&(this.is_running=!1,e(this.makeResultObj())),this.nextItem(e)}makeResultObj(){return{datas:this.result_common_temp.datas.sort(function(t,e){return t.index-e.index}).map(t=>t.value),errs:this.result_common_temp.errs.sort(function(t,e){return t.index-e.index}).map(t=>t.value)}}nextItem(e){var t=this.queues.shift();t&&t.task.call(this).then(t=>{this.checker(t,e)})}runner(e){0<this.tasks.length?this.tasks.forEach(t=>{t.task.call(this).then(t=>{this.checker(t,e)})}):(this.is_running=!1,e(this.makeResultObj()))}}class C{constructor(t,e){this.current=t,this.iframe=e,this.lstGlobalSources=[],this.lstPluginSources=[],this.lstStyleGlobalSource=[],this.lstStylePluginSource=[],Object.prototype.hasOwnProperty.call(window,C.ControlName)?this.lstGlobalSources=window[C.ControlName]:window[C.ControlName]=this.lstGlobalSources,Object.prototype.hasOwnProperty.call(window,C.ControlElementStyleName)?this.lstStyleGlobalSource=window[C.ControlElementStyleName]:window[C.ControlElementStyleName]=this.lstStyleGlobalSource;t=document.getElementById(C.ControlElementStyleName);this.currentStyle=t||document.createElement("style"),this.currentStyle.id=C.ControlElementStyleName,this.iframeStyle=document.createElement("style"),this.current.head.appendChild(this.currentStyle),this.iframe.head.appendChild(this.iframeStyle)}loadScriptWithDocument(n,i,s){return new Promise(t=>{var e=i.find(t=>t.name===n.name);e&&n.mode!==a.FRAME?e.pushCallback(t):(i.push(n),t(n.load(s)))})}loadMultipleSrcJs(n){return new Promise(t=>{const e=new k;n.forEach(t=>{e.addTask(this,this.loadSrcJs,[t.name,t.url,t.mode])}),e.start().then(()=>{t(!0)})})}loadSrcJs(i,s,o){return new Promise(t=>{var e,n=new f(i,s,o);o===a.FRAME&&t(this.loadScriptWithDocument(n,this.lstPluginSources,this.iframe)),o===a.DOCUMENT&&t(this.loadScriptWithDocument(n,this.lstGlobalSources,this.current)),o===a.ALL&&((e=new k).addTask(this,this.loadScriptWithDocument,[Object.assign(Object.assign({},n),{mode:a.FRAME}),this.lstPluginSources,this.iframe]),e.addTask(this,this.loadScriptWithDocument,[Object.assign(Object.assign({},n),{mode:a.DOCUMENT}),this.lstGlobalSources,this.current]),e.start().then(()=>{t(!0)}))})}loadStyle(t,e,n){return n!==a.DOCUMENT||this.lstStyleGlobalSource.includes(t)?n!==a.FRAME||this.lstStylePluginSource.includes(t)?void(n===a.ALL&&(this.lstStyleGlobalSource.includes(t)||(this.lstStyleGlobalSource.push(t),this.loadStyleToElement(e,this.currentStyle)),this.lstStylePluginSource.includes(t)||(this.lstStylePluginSource.push(t),this.loadStyleToElement(e,this.iframeStyle)))):(this.lstStylePluginSource.push(t),this.loadStyleToElement(e,this.iframeStyle)):(this.lstStyleGlobalSource.push(t),this.loadStyleToElement(e,this.currentStyle))}loadStyleToElement(t,e){e.textContent=e.textContent+=t}static get ControlName(){return"aztSourceLoadManager__PublicAPI"}static get ControlElementStyleName(){return"azt-source-load-manager__style"}}const v=`.mce-content-body  {
    margin: 0 3rem;
    color: #1e293b;
    line-height: 25px;
}
.mce-content-body p { margin: 0; padding: 0; }
.mce-content-body img { max-width: 100% }

.azt-editor-placeholder {
    display: none;
    position: absolute !important;
    color: #969faf !important;
    font-size: small !important;
    align-items: center !important;
    margin-left: 3px !important;
    z-index: 999 !important;
    -webkit-user-select: none !important; /* Safari */
    -ms-user-select: none !important; /* IE 10 and IE 11 */
    user-select: none !important; /* Standard syntax */
}

.azt-editor-placeholder kbd {
    align-items: center !important;
    background: linear-gradient(-225deg,#d5dbe4,#f8f8f8) !important;
    border-radius: 2px !important;
    box-shadow: inset 0 -2px 0 0 #cdcde6,inset 0 0 1px 1px #fff,0 1px 2px 1px rgba(30,35,90,0.4) !important;
    display: flex !important;
    height: 18px !important;
    justify-content: center !important;
    margin: 0 5px !important;
    padding: 0 5px !important;
    color: #969faf !important;
    border: 0 !important;
    width: fit-content !important;
    font-size: x-small;
}

.azt-editor-suggestion {
    display: none;
    position: absolute !important;
    background: #fff !important;
    border-width: 1px 1px 2px !important;
    border-style: solid !important;
    border-color: #969faf63 !important;
    border-radius: 10px;
    padding: 5px !important;
    margin-top: 30px;
    z-index: 999999;
    box-shadow: inset 0 -1px 0 0 #ECEFF1, inset 0 0 1px 1px #fff, 0 1px 1px 1px #969faf !important;
}
.azt-editor-suggestion li {
    display: flex;
    align-items: center;
    padding: 5px 20px !important;
    border-radius: 5px;
    list-style: none;
    cursor: pointer !important;
    font-weight: 500;
}
.azt-editor-suggestion li span {
    display: flex;
    align-items: center;
    justify-content: center;
}

.azt-editor-suggestion .active {
    background: #2361ae;
    color: #ffffff;
}
.azt-editor-suggestion li svg {
    border-radius: 5px;
    margin-right: 10px;
}
`,x=e=>{var n;e.on("init",()=>{var t=new C(document,e.getDoc());t.loadStyle(i+"__default",v,a.ALL),n=new y(e,t)}),e.on("keydown",function(t){n&&"Enter"===t.key&&n.onHandleEnterPressMasterKeyDown(t)})};tinymce.PluginManager.add(i,x)}();