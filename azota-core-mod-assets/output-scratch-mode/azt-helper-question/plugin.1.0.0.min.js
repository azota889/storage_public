!function(){"use strict";const a="azt-helper-question",i="azt-dispatch-setup-api",n="azt-dispatch-push-json-content",t="azt-answer-managers";var o,r,e;(e=o=o||{})[e.FRAME=0]="FRAME",e[e.DOCUMENT=1]="DOCUMENT",e[e.ALL=2]="ALL",(e=r=r||{})[e.AztSigma=0]="AztSigma",e[e.AztImage=1]="AztImage",e[e.AztAdd=2]="AztAdd",e[e.AztBadge=3]="AztBadge",e[e.AztLayoutList=4]="AztLayoutList",e[e.AztBraces=5]="AztBraces",e[e.AztListChecks=6]="AztListChecks";const l={setup:(e,n)=>{e.addCommand("aztAddSuggestionActionMenu",(e,t)=>{n.addOneMenu(t)})},call:(e,t)=>{e.execCommand("aztAddSuggestionActionMenu",!1,t)},name:"aztAddSuggestionActionMenu"},d={setup:(e,n)=>{e.addCommand("aztHiddenOneSuggestionActionMenu",(e,t)=>{n.hiddenOneMenu(t)})},call:(e,t)=>{e.execCommand("aztHiddenOneSuggestionActionMenu",!1,t)},name:"aztHiddenOneSuggestionActionMenu"},s={setup:(e,n)=>{e.addCommand("aztOpenOneSuggestionActionMenu",(e,t)=>{n.openOneMenu(t)})},call:(e,t)=>{e.execCommand("aztOpenOneSuggestionActionMenu",!1,t)},name:"aztOpenOneSuggestionActionMenu"},c={setup:(e,n)=>{e.addCommand("aztHiddenSuggestionActionMenu",(e,t)=>{n.hidden(t)})},call:(e,t)=>{e.execCommand("aztHiddenSuggestionActionMenu",!1,t)},name:"aztHiddenSuggestionActionMenu"},u={setup:(e,n)=>{e.addCommand("aztLoadScriptSource",(e,t)=>{n.loadSrcJs(t.name,t.url,t.mode).then(t.callback)})},call:(e,t)=>{e.execCommand("aztLoadScriptSource",!1,t)},name:"aztLoadScriptSource"},h={setup:(e,n)=>{e.addCommand("aztLoadMultipleScriptSource",(e,t)=>{n.loadMultipleSrcJs(t.lst).then(t.callback)})},call:(e,t)=>{e.execCommand("aztLoadMultipleScriptSource",!1,t)},name:"aztLoadMultipleScriptSource"},p={setup:(e,n)=>{e.addCommand("aztLoadStyleSource",(e,t)=>{n.loadStyle(t.name,t.content,t.mode)})},call:(e,t)=>{e.execCommand("aztLoadStyleSource",!1,t)},name:"aztLoadStyleSource"},g={setup:(e,n)=>{e.addCommand("aztSetContentPlaceholderActionMenu",(e,t)=>{n.setContent(t)})},call:(e,t)=>{e.execCommand("aztSetContentPlaceholderActionMenu",!1,t)},name:"aztSetContentPlaceholderActionMenu"};class m{constructor(e){this.editor=e}loadScript(t,n,a){return new Promise(e=>{u.call(this.editor,{name:t,url:n,mode:a,callback:e})})}loadMultipleScript(t){return new Promise(e=>{h.call(this.editor,{lst:t,callback:e})})}loadStyle(e,t,n){return p.call(this.editor,{name:e,content:t,mode:n})}hiddenSuggestionMenu(e){return c.call(this.editor,e)}addOneSuggestionMenu(e,t,n,a,i){return l.call(this.editor,{name:e,callback:t,svgIcon:n,hidden:a,hiddenOnExcuse:i})}openOneSuggestionMenu(e){return s.call(this.editor,e)}hiddenOneSuggestionMenu(e){return d.call(this.editor,e)}setContentPlaceholder(e){return g.call(this.editor,e)}pushJsonContent(e,t){return this.editor.fire(n,{name:e,content:t})}static replaceTranslateService(e){Object.prototype.hasOwnProperty.call(window,"aztEditorFnsTranslateService")||(window.aztEditorFnsTranslateService=e)}translate(e,t){return window.aztEditorFnsTranslateService?window.aztEditorFnsTranslateService(e,t):null!=t?t:e}}class z{constructor(e,t){this.editor=e,this.pluginApi=t,this.pluginApi.addOneSuggestionMenu(this.pluginApi.translate("lang_editor_common_add_detailed_solution","Thêm lời giải chi tiết"),"azt-helper-question-add",r.AztListChecks,!1,!0),this.pluginApi.addOneSuggestionMenu(this.pluginApi.translate("lang_editor_common_delete_detailed_solution","Xóa lời giải chi tiết"),"azt-helper-question-remove",r.AztListChecks,!0,!0),this.editor.on(n,e=>{"QUESTION_MULTIPLE_CHOICE_JSON"===e.name&&this.processJsonToElement(e.content)}),this.editor.on("NewBlock",e=>{this.processWithNewLine(e.newBlock),this.detachElementWithBody()}),this.editor.on("keydown",()=>{this.detachElementWithBody()}),this.editor.addCommand("azt-helper-question-remove",()=>{this.getAllHelperElement().forEach(e=>{e.remove()})})}processJsonToElement(e){var t=document.createElement("div");t.classList.add("azt-helper-question-manager"),t.setAttribute("data-translate-text",this.pluginApi.translate("lang_editor_common_detailed_solution_guide","Hướng dẫn giải chi tiết")),t.innerHTML=e.help,this.editor.getBody().appendChild(t)}loopCheck(e){return e&&e.classList.contains("azt-helper-question-manager"),0<e.textContent.length?e:this.loopCheck(e.nextElementSibling)}detachElementWithBody(){var e;0<this.editor.getBody().querySelectorAll("."+t).length&&(e=this.editor.getBody().querySelector("."+t),e=this.loopCheck(e.nextElementSibling))&&(e.classList.add("azt-helper-question-manager"),e.setAttribute("data-translate-text",this.pluginApi.translate("lang_editor_common_detailed_solution_guide","Hướng dẫn giải chi tiết"))),this.editor.getBody().querySelectorAll(".azt-helper-question-manager").forEach((e,t)=>{0<t&&e.classList.remove("azt-helper-question-manager")}),0<this.editor.getBody().querySelectorAll(".azt-helper-question-manager").length?(this.pluginApi.hiddenOneSuggestionMenu("azt-helper-question-add"),this.pluginApi.openOneSuggestionMenu("azt-helper-question-remove")):(this.pluginApi.openOneSuggestionMenu("azt-helper-question-add"),this.pluginApi.hiddenOneSuggestionMenu("azt-helper-question-remove"))}getAllHelperElement(){var e=this.editor.getBody().querySelector(".azt-helper-question-manager");if(!e)return[];var t=[];let n=e;for(;n;)t.push(n),n=n.nextElementSibling;return t}processWithNewLine(e){e.classList.contains("azt-helper-question-manager")&&e.classList.remove("azt-helper-question-manager")}}const S=`.azt-helper-question-manager {
    width: 100%;
    position: relative;
    margin-top: 55px !important;
}

.azt-helper-question-manager::before {
    content: '';
    width: 100%;
    top: -15px;
    position: absolute;
    height: 1px;
    background: #2361ae;
}

.azt-helper-question-manager::after {
    content: attr(data-translate-text);;
    position: absolute;
    transform: translate(-50%, -50%);
    left: 50%;
    top: -15px;
    color: #2361ae;
    display: block;
    width: fit-content;
    padding: 5px 10px;
    text-transform: uppercase;
    background: #fff;
    border-radius: 10px;
}`,A=t=>{var n;n=t,new Promise(e=>{n.on(i,()=>{e(new m(n))})}).then(e=>{e.loadStyle(a+"__default",S,o.ALL),new z(t,e)})};tinymce.PluginManager.add(a,A)}();